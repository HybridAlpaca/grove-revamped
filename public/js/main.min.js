webpackJsonp([0],[function(e,t,n){"use strict";var o=n(1),i=n(2),a=n(8),r=e.exports=new Map;r.set("time",Date.now()),r.set("tick",0),r.set("controls",{}),r.set("scene",new o.Scene),r.set("renderer",new o.WebGLRenderer),r.set("camera",new o.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,5e3)),r.set("listener",new o.AudioListener),r.get("camera").add(r.get("listener")),r.set("player",{}),r.set("entities",[]),r.set("labels",[]),r.set("tweens",[]),r.set("world",new i.World),r.set("cache",{audio:{},json:{}}),r.set("events",a.channel("events")),r.set("load",function(e,t){t=t||{},e.castShadow=!0,e.receiveShadow=!0;for(var n=[],o=[],a=0;a<e.geometry.vertices.length;a++){var s=e.geometry.vertices[a];n.push(new i.Vec3(s.x,s.y,s.z))}for(var a=0;a<e.geometry.faces.length;a++){var l=e.geometry.faces[a];o.push([l.a,l.b,l.c])}var c=new i.ConvexPolyhedron(n,o),d=new i.Body({mass:t.mass||0,material:t.material||void 0});return d.addShape(c),d.position.copy(e.position),d.quaternion.copy(e.quaternion),r.get("world").add(d),{body:d,shape:c,mesh:e}})},,,,function(e,t,n){"use strict";function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,o)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(o)},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(1),c=n(2),d=n(5),h=n(0),u=n(3),p=t.Entity=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Entity",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.Object3D,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new c.Body,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(a(this,e),console.log("Entity: "+t+" created"),this.id=t,this.uuid=Math.random(),this.events={},this.opts=i,this.sounds=[],this.opts.sounds)for(var r=0;r<this.opts.sounds.length;r++)this.loadAudio(this.opts.sounds[r],r);this.mesh=n,this.mesh.name=this.id,this.body=o,h.get("scene").add(n),h.get("world").add(o),h.get("entities").push(this)}return s(e,[{key:"update",value:function(e){this.mesh.position.copy(this.body.position),this.callEvent("update")}},{key:"remove",value:function(){this.callEvent("remove"),h.get("scene").remove(this.mesh),h.get("world").remove(this.body),h.get("entities").splice(h.get("entities").indexOf(this),1)}},{key:"loadAudio",value:function(e,t){var n=this;if(e)if(h.get("cache").audio[e])this.sounds[t]=new l.PositionalAudio(h.get("listener")),this.sounds[t].setBuffer(h.get("cache").audio[e]),this.sounds[t].setRefDistance(30),this.mesh&&this.mesh.add(this.sounds[t]),this.sounds[t].onEnded(function(){return n.sounds[t].stop()});else{var o=new l.AudioLoader;o.load("/assets/sfx/"+e,function(o){h.get("cache").audio[e]=o,n.sounds[t]=new l.PositionalAudio(h.get("listener")),n.sounds[t].setBuffer(o),n.sounds[t].setRefDistance(30),n.mesh.add(n.sounds[t]),n.sounds[t].onEnded(function(){return n.sounds[t].stop()})})}}},{key:"addEventListener",value:function(e,t){e in this.events||(this.events[e]=[]),this.events[e].push(t)}},{key:"removeEventListener",value:function(e,t){}},{key:"callEvent",value:function(e){if(e in this.events){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=!0,a=!1,r=void 0;try{for(var s,l=this.events[e][Symbol.iterator]();!(i=(s=l.next()).done);i=!0){s.value.apply(void 0,n)}}catch(e){a=!0,r=e}finally{try{!i&&l.return&&l.return()}finally{if(a)throw r}}}}}]),e}(),v=t.Living=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Living Entity",n=arguments[1],i=arguments[2],r=arguments[3];a(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,r));return s.lastDamaged=0,s.lastAttacked=0,s.hp=Number,s.hpMax=Number,s.mp=Number,s.mpMax=Number,s.stm=Number,s.stmMax=Number,s.str=Number,s.dex=Number,s.int=Number,s.cnt=Number,s.chr=Number,s.inv=[],s.effects=[],s}return i(t,e),s(t,[{key:"attack",value:function(e){h.get("controls").enabled&&(e.damage(this.dmg,this),this.lastAttacked=Date.now(),this.callEvent("attack"))}},{key:"damage",value:function(e,t){h.get("controls").enabled&&(this.hp-=e,this.hp<=0&&this.kill(t),this.lastDamaged=Date.now(),this.callEvent("damage"))}},{key:"heal",value:function(e){h.get("controls").enabled&&(Date.now()-this.lastDamaged>5e3&&(this.hp+=e),this.hp>=this.hpMax&&(this.hp=this.hpMax),this.callEvent("heal"))}},{key:"kill",value:function(e){h.get("controls").enabled&&(this.remove(),this.callEvent("kill",{attacker:e}))}},{key:"update",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e),h.get("tick")%50==0&&this.heal(1)}}]),t}(p),m=t.AI=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AI",n=arguments[1],i=arguments[2],r=arguments[3];a(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,r));return s.target=null,s.seen=!1,s.tween=!1,s.hp=5,s.hpMax=5,s.mp=1,s.mpMax=1,s.stm=3,s.stmMax=3,s.str=1,s.dex=1,s.int=1,s.cnt=1,s.chr=1,s}return i(t,e),s(t,[{key:"update",value:function(e){var n=this;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e);var o=this.mesh.position,i=!0,a=!1,s=void 0;try{for(var c,u=h.get("entities")[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var p=c.value;p.id!=this.id&&(o.distanceTo(p.mesh.position)>50||this.data&&this.data.hostility&&this.data.hostility[1].has(p.id)||(this.target&&o.distanceTo(p.mesh.position)<o.distanceTo(this.target.mesh.position)?(this.target=p,this.sounds[0]&&h.get("controls").enabled&&this.sounds[0].play(),this.callEvent("newTarget",this.target)):this.target||(this.target=p,this.sounds[0]&&h.get("controls").enabled&&this.sounds[0].play(),this.callEvent("newTarget",this.target))))}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}this.target&&o.distanceTo(this.target.mesh.position)>50&&(this.target=null);var v=this.spd||7;if(this.addEventListener("damage",function(){n.sounds[2]&&h.get("controls").enabled&&!n.sounds[2].isPlaying&&n.hp>0&&n.sounds[2].play()}),this.addEventListener("kill",function(){n.sounds[3]&&h.get("controls").enabled&&!n.sounds[3].isPlaying&&n.sounds[3].play()}),this.target){var m=this.target.mesh.position;if(!this.tween){this.tween=!0;var y=(new l.Euler).copy(this.mesh.rotation);this.mesh.lookAt(new l.Vector3(m.x,o.y,m.z));var f=(new l.Euler).copy(this.mesh.rotation);this.mesh.rotation.copy(y);var g=new d.Tween(this.mesh.rotation).to({x:y.x,y:f.y,z:y.z},60).start().onComplete(function(){n.tween=!1,h.get("tweens").splice(h.get("tweens").indexOf(g),1)});h.get("tweens").push(g)}var w=0;w=this.data&&this.data.hostility[0].has(this.target.id)?-1:this.data&&this.data.hostility[2].has(this.target.id)?1:this.opts.hostility;var b=1;w>0&&(b*=-1),0!=w&&o.distanceTo(m)>(w>0?10:5)?(o.x<m.x?this.body.velocity.x+=b:o.x>m.x&&(this.body.velocity.x-=b),o.z<m.z?this.body.velocity.z+=b:o.z>m.z&&(this.body.velocity.z-=b)):h.get("tick")%50==0&&w<0&&(this.attack(this.target),this.sounds[1]&&h.get("controls").enabled&&this.sounds[1].play())}else this.body.velocity.x=0,this.body.velocity.z=0;this.body.velocity.x>v?this.body.velocity.x=v:this.body.velocity.x<-v&&(this.body.velocity.x=-v),this.body.velocity.z>v?this.body.velocity.z=v:this.body.velocity.z<-v&&(this.body.velocity.z=-v)}}]),t}(v);t.Player=function(e){function t(){a(this,t);var e=new c.Sphere(1.3),n=new c.Body({mass:5});n.addShape(e);var i=new l.Raycaster(new l.Vector3(0,40,0),new l.Vector3(0,-1,0)),r=i.intersectObjects(h.get("scene").children,!0);if(r.length>0){var s=r[0].point;n.position.set(s.x,s.y,s.z)}else n.position.set(200,2,0);var d=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"player",new l.Object3D,n));return d.hp=20,d.hpMax=20,d.spd=1,d.dmg=1,d}return i(t,e),s(t,[{key:"update",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e),u("#hp").html(this.hp+"/"+this.hpMax+" hp"),this.body.velocity.x*=.925,this.body.velocity.z*=.925}},{key:"damage",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"damage",this).call(this,e),u("#vignette").fadeIn(550).fadeOut(550)}}]),t}(v),t.Creature=function(e){function t(e,i){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,new l.Object3D,new c.Body,i)),s=n(13);if(!s[e])throw new Error("Error: cannot find creature with id of "+e);var d=s[e];r.data=d,r.id=r.data.id,r.inv=d.inv;for(var u in d.stats)r[u]=d.stats[u];return(new l.ObjectLoader).load("/assets/3d/"+d.path+".json",function(e){h.get("cache").json[d.path]=e;var t=new c.Body({mass:5});t.addShape(new c.Sphere(1));var n=void 0;if(n=new c.Vec3(i.pos.x||10,i.pos.y||20,i.pos.z||10),d.meta&&d.meta.spawn){var o=d.meta.spawn;n=6==o.length?new c.Vec3(Math.interval(o[0],o[1]),Math.interval(o[2],o[3]),Math.interval(o[4],o[5])):new c.Vec3(o[0],o[1],o[2])}var a=new l.Raycaster(new l.Vector3(n.x,n.y,n.z),new l.Vector3(0,-1,0)),s=a.intersectObjects(h.get("scene").children,!0);if(s.length>0){var u=s[0].point;t.position.set(u.x,u.y+3,u.z)}else t.position.set(n.x,n.y,n.z);t.linearDamping=.9,e.traverse(function(e){var t=!0,n=!1,o=void 0;try{for(var i,a=d.mesh[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=i.value;if(r.name.toLowerCase()==e.name.toLowerCase())for(var s in r)e.material[s]=r[s],"color"==s&&(e.material[s]=new l.Color(r[s]))}}catch(e){n=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw o}}}),r.mesh=e,h.get("scene").add(r.mesh),r.body=t,h.get("world").add(r.body)}),r.addEventListener("kill",function(t){var o=!0,i=!1,a=void 0;try{for(var s,l=r.inv[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,d=n(14);if(!d[c.id])throw new Error("Error: cannot find item with id of "+e);var u=Math.round(Math.random()*c.max)+c.min;if(u>c.max&&(u=c.max),u){for(var p=0;p<u;p++)t.attacker.inv.push(d[c.id]);t.attacker==h.get("player")&&(u>1?Materialize.toast(c.id+" ("+u+") added",1e3):Materialize.toast(c.id+" added",1e3))}}}catch(e){i=!0,a=e}finally{try{!o&&l.return&&l.return()}finally{if(i)throw a}}}),r}return i(t,e),s(t,[{key:"update",value:function(){if(r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),(!this.data.meta||!this.data.meta.spawn)&&this.mesh.position.distanceTo(h.get("player").mesh.position)>250){var e=new c.Vec3;e.x=Math.interval(h.get("player").mesh.position.x-200,h.get("player").mesh.position.x+200),e.y=20,e.z=Math.interval(h.get("player").mesh.position.x-200,h.get("player").mesh.position.x+200);var n=new l.Raycaster(new l.Vector3(e.x,e.y,e.z),new l.Vector3(0,-1,0)),o=n.intersectObjects(h.get("scene").children,!0);if(o.length>0){var i=o[0].point;this.body.position.set(i.x,i.y+3,i.z)}else this.body.position.set(e.x,e.y,e.z)}}}]),t}(m),t.NPC=function(e){function t(e,i){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,new l.Object3D,new c.Body,i)),s=n(15);if(!s[e])throw new Error("Error: cannot find NPC with id of "+e);var d=s[e];r.data=d,r.opts.hostility=1,r.inv=d.inv;for(var u in d.stats)r[u]=d.stats[u];(new l.ObjectLoader).load("/assets/3d/"+d.path+".json",function(e){e.scale.set(2,2,2);var t=new c.Body({mass:5});t.addShape(new c.Sphere(.75));var n=void 0;if(n=new c.Vec3(i.pos.x||10,i.pos.y||20,i.pos.z||10),d.meta&&d.meta.spawn){var o=d.meta.spawn;n=6==o.length?new c.Vec3(Math.interval(o[0],o[1]),Math.interval(o[2],o[3]),Math.interval(o[4],o[5])):new c.Vec3(o[0],o[1],o[2])}t.position.set(n.x,n.y,n.z),t.linearDamping=.9,r.mesh=e,h.get("scene").add(r.mesh),r.body=t,h.get("world").add(r.body)}),r.addEventListener("newTarget",function(e){r.hasChosenTarget=r.hasChosenTarget||!1,r.hasSpokenInteract=r.hasSpokenInteract||!1,r.hasChosenTarget||(r.target=null),r.sounds[0]=null}),r.addEventListener("interact",function(){var e=0,t=!0,n=!1,o=void 0;try{for(var i,a=h.get("player").inv[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)"gelatin"==i.value.id&&e++}catch(e){n=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw o}}if(e<5){var s=document.createElement("audio");s.src="/assets/sfx/wicket-request.mp3",s.addEventListener("ended",function(){new Audio("/assets/sfx/wicket-tutorial-inventory.mp3").play()}),s.play()}else r.hasChosenTarget=!0,r.target=h.get("player"),new Audio("/assets/sfx/wicket-thanks.mp3").play()});var p=h.get("events").subscribe("system.pointerlock.enter",function(){var e=document.createElement("audio");e.src="/assets/sfx/wicket-help.mp3",e.addEventListener("ended",function(){var e=document.createElement("audio");e.src="/assets/sfx/wicket-tutorial-look.mp3",e.addEventListener("ended",function(){var e=h.get("events").subscribe("player.look",function(){var t=document.createElement("audio");t.src="/assets/sfx/wicket-success.mp3",t.addEventListener("ended",function(){var t=document.createElement("audio");t.src="/assets/sfx/wicket-tutorial-move.mp3",t.addEventListener("ended",function(){var t=h.get("events").subscribe("player.move",function(){var e=document.createElement("audio");e.src="/assets/sfx/wicket-success.mp3",e.addEventListener("ended",function(){var e=document.createElement("audio");e.src="/assets/sfx/wicket-tutorial-attack.mp3",e.addEventListener("ended",function(){var e=h.get("events").subscribe("system.click",function(){var t=document.createElement("audio");t.src="/assets/sfx/wicket-success.mp3",t.addEventListener("ended",function(){var e=document.createElement("audio");e.src="/assets/sfx/wicket-help-2.mp3",e.addEventListener("ended",function(){new Audio("/assets/sfx/wicket-tutorial-interact.mp3").play()}),e.play()}),t.play(),e.unsubscribe()})}),e.play()}),e.play(),t.unsubscribe()});e.unsubscribe()}),t.play()}),t.play(),e.unsubscribe()})}),e.play()}),e.play(),p.unsubscribe()});return r}return i(t,e),t}(m)},,function(e,t,n){"use strict";var o=n(4).NPC;window.onerror=alert,window.Grove={version:"1.3.5",globals:n(0)},Math.interval=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},Array.prototype.has=function(e){return this.indexOf(e)>-1};window.wicket=new o("wicket",{pos:{},sounds:["wicket.mp3",null,"wicket-hurt.mp3","wicket-hurt.mp3"]});n(16)(),n(17)(),n(22)(),n(23),n(24)},,,,,,,function(e,t){e.exports={slime:{name:"Slime",path:"slime/slime",id:"slime",stats:{hp:3,hpMax:3,dmg:1,spd:5},hostility:[["wicket","player"],["slime","slime.red","slime.blue"],[]],inv:[{id:"gelatin",min:1,max:3}],mesh:[{name:"outer",transparent:!0,opacity:.3}]},"slime.red":{name:"Red Slime",path:"slime/slime",id:"slime.red",stats:{hp:5,hpMax:5,dmg:2,spd:5},hostility:[["wicket","player"],["slime","slime.red","slime.blue"],[]],inv:[{id:"gelatin",min:1,max:2}],meta:{spawn:[-500,200,250,300,310,390]},mesh:[{name:"outer",transparent:!0,opacity:.3,color:16711680},{name:"inner",color:16711680}]},"slime.blue":{name:"Blue Slime",path:"slime/slime",id:"slime.blue",stats:{hp:1,hpMax:1,dmg:7,spd:15},hostility:[["wicket","player"],["slime","slime.red","slime.blue"],[]],inv:[{id:"gelball",min:1,max:2}],mesh:[{name:"outer",transparent:!0,opacity:.3,color:255},{name:"inner",color:255}]}}},function(e,t){e.exports={gelatin:{name:"Gelatin",id:"gelatin",desc:"Like jello, but not edible.",path:"/assets/icons/gelatin.png",weight:1,value:3,effects:{hp:-1}},gelball:{name:"Ball of Gel",id:"gelball",desc:"Compressed gelatin, has distinctive healing properties.",path:"/assets/icons/slow-blob.png",weight:3,value:3,effects:{hp:5}}}},function(e,t){e.exports={wicket:{name:"Wicket",id:"wicket",path:"wicket/wicket",stats:{hp:30,hpMax:30,spd:20,dmg:15},hostility:[["player"],[],[]],meta:{spawn:[115,32,-30],sounds:["wicket.mp3","silence.wav","wicket-hurt.mp3","silence.wav"]}}}},function(e,t,n){"use strict";var o=n(4),i=n(2),a=(n(1),n(0)),r=a.get("world");e.exports=function(){r.quatNormalizeSkip=0,r.quatNormalizeFast=!1;var e=new i.GSSolver;r.defaultContactMaterial.contactEquationStiffness=1e9,r.defaultContactMaterial.contactEquationRelaxation=4,e.iterations=7,e.tolerance=.1;r.solver=new i.SplitSolver(e),r.gravity.set(0,-20,0),r.broadphase=new i.NaiveBroadphase;var t=new i.Material("slipperyMaterial"),n=new i.ContactMaterial(t,t,0,.3);r.addContactMaterial(n),a.set("player",new o.Player)}},function(e,t,n){"use strict";function o(){r.get("camera").aspect=window.innerWidth/window.innerHeight,r.get("camera").updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight),console.log("Window resized to "+window.innerWidth+", "+window.innerHeight)}var i=n(3),a=n(1),r=(n(2),n(0)),s=r.get("renderer"),l=r.get("scene");e.exports=function(){var e=n(18);a.DefaultLoadingManager.onProgress=function(e,t,n){console.log("Loading "+e+" ("+t+"/"+n+")"),i("#loaded").text(Math.floor(t/n*100)+"% - v."+window.Grove.version)},a.DefaultLoadingManager.onLoad=function(){console.log("Loading complete"),i("#instructions").has("h4").length||i("#instructions").html("<h4>"+e[Math.floor(Math.random()*e.length)]+"</h4>")},a.DefaultLoadingManager.onError=function(e){console.error("Error loading "+e)},l.fog=new a.FogExp2(16777215,.005);var t=n(19).DayNight,c=new t.SunSphere;l.add(c.object3d);var d=new t.Skydom;l.add(d.object3d);var h=new t.SunLight;l.add(h.object3d);var u=1/6*Math.PI*2,p=new a.AmbientLight(2236962);l.add(p),r.get("events").subscribe("system.update",function(e){r.get("controls").enabled&&(u+=1e-5*Math.PI*2,c.update(u),d.update(u),h.update(u))});var v=n(20);r.set("controls",new v(r.get("camera"),r.get("player").body)),l.add(r.get("controls").getObject()),n(21)(r.get("controls")),(new a.ObjectLoader).load("/assets/3d/skjar-isles/skjar-isles.json",function(e){l.add(e),e.castShadow=!0,e.receiveShadow=!0,e.traverse(function(e){e.castShadow=!0,e.receiveShadow=!0,e instanceof a.Mesh&&!/NP/gi.test(e.name)?(console.log("Loading "+e.name),r.get("load")(e)):"NP_Ocean"==e.name&&(e.material.transparent=!0,e.material.opacity=.9)})}),s.shadowMap.enabled=!0,s.shadowMapSoft=!0,s.setSize(window.innerWidth,window.innerHeight),s.setClearColor(l.fog.color,1),document.body.appendChild(s.domElement),window.addEventListener("resize",o,!1)}},function(e,t){e.exports=["While the island's mountains may be fun to climb, keep a look out; they are teeming with some of The Grove's more formiddable creatures.","OOOOO OOOOO OOOOO - Hunter Sokolis, time unknown","There is currently no fall damage in the game - take advantage of that while you can.","A slime's power depends on its color. Green slimes are easy to beat, whereas red slimes are harder.","Please tolerate our crappy graphics","Can you find Hunter's hidden characters?","There will be an update to this game eventually. Keyword is eventually.","Can you find the mysterious ButtBook?","How many slimes can you kill?","Beware the foul-smelling train!","Did you know Wicket is a candle?","<span class='rune'>welcome young traveller</span> - ancient Grove folklore"]},function(e,t,n){"use strict";var o=n(1),i=e.exports=i||{};i.DayNight={},i.DayNight.baseURL="../",i.DayNight.currentPhase=function(e){return Math.sin(e)>Math.sin(0)?"day":Math.sin(e)>Math.sin(-Math.PI/6)?"twilight":"night"},i.DayNight.StarField=function(){var e=o.ImageUtils.loadTexture(i.DayNight.baseURL+"images/galaxy_starfield.png"),t=new o.MeshBasicMaterial({map:e,side:o.BackSide,color:8421504}),n=new o.SphereGeometry(4500,32,32),a=new o.Mesh(n,t);this.object3d=a,this.update=function(e){var n=i.DayNight.currentPhase(e);if("day"===n)a.visible=!1;else if("twilight"===n)a.visible=!1;else{a.visible=!0,a.rotation.y=e/5;var o=Math.abs(Math.sin(e));t.color.setRGB(o,o,o)}}},i.DayNight.SunLight=function(){var e=new o.DirectionalLight(16777215,1);this.object3d=e,this.update=function(t){e.position.x=0,e.position.y=9e4*Math.sin(t),e.position.z=9e4*Math.cos(t);var n=i.DayNight.currentPhase(t);"day"===n?e.color.set("rgb(255,"+(Math.floor(200*Math.sin(t))+55)+","+Math.floor(200*Math.sin(t))+")"):"twilight"===n?(e.intensity=1,e.color.set("rgb("+(255-Math.floor(510*Math.sin(t)*-1))+","+(55-Math.floor(110*Math.sin(t)*-1))+",0)")):e.intensity=1}},i.DayNight.SunSphere=function(){var e=new o.SphereGeometry(20,30,30),t=new o.MeshBasicMaterial({color:16711680}),n=new o.Mesh(e,t);this.object3d=n,this.update=function(e){n.position.x=0,n.position.y=400*Math.sin(e),n.position.z=400*Math.cos(e);var t=i.DayNight.currentPhase(e);"day"===t?n.material.color.set("rgb(255,"+(Math.floor(200*Math.sin(e))+55)+","+(Math.floor(200*Math.sin(e))+5)+")"):"twilight"===t&&n.material.color.set("rgb(255,55,5)")}},i.DayNight.Skydom=function(){var e=new o.SphereGeometry(4500,32,15),t=i.DayNight.Skydom.Shader,n=o.UniformsUtils.clone(t.uniforms),a=new o.ShaderMaterial({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:n,side:o.BackSide}),r=new o.Mesh(e,a);this.object3d=r,this.update=function(e){var t=i.DayNight.currentPhase(e);"day"===t?(n.topColor.value.set("rgb(0,120,255)"),n.bottomColor.value.set("rgb(255,"+(Math.floor(200*Math.sin(e))+55)+","+Math.floor(200*Math.sin(e))+")")):"twilight"===t?(n.topColor.value.set("rgb(0,"+(120-Math.floor(240*Math.sin(e)*-1))+","+(255-Math.floor(510*Math.sin(e)*-1))+")"),n.bottomColor.value.set("rgb("+(255-Math.floor(510*Math.sin(e)*-1))+","+(55-Math.floor(110*Math.sin(e)*-1))+",0)")):(n.topColor.value.set("black"),n.bottomColor.value.set("black"))}},i.DayNight.Skydom.Shader={uniforms:{topColor:{type:"c",value:(new o.Color).setHSL(.6,1,.75)},bottomColor:{type:"c",value:new o.Color(16777215)},offset:{type:"f",value:400},exponent:{type:"f",value:.6}},vertexShader:["varying vec3 vWorldPosition;","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 topColor;","uniform vec3 bottomColor;","uniform float offset;","uniform float exponent;","varying vec3 vWorldPosition;","void main() {","\tfloat h = normalize( vWorldPosition + offset ).y;","\tgl_FragColor = vec4( mix( bottomColor, topColor, max( pow( h, exponent ), 0.0 ) ), 1.0 );","}"].join("\n")}},function(e,t,n){"use strict";var o=n(1),i=n(2),a=n(0);e.exports=function(e,t){var n=new Audio("/assets/sfx/leaves01.ogg"),r=this,s=new o.Object3D;s.add(e);var l=new o.Object3D;l.position.y=2,l.add(s);var c=new o.Quaternion,d=!1,h=!1,u=!1,p=!1,v=!1,m=new i.Vec3,y=new i.Vec3(0,1,0);t.addEventListener("collide",function(e){var n=e.contact;if(n.bi.id==t.id?n.ni.negate(m):m.copy(n.ni),m.dot(y)>.5){if(v=!0,!a.get("player"))return;var o=a.get("player").body.velocity.y;o<=-60&&a.get("player").damage(-Math.floor(o))}});var f=t.velocity,g=Math.PI/2,w=function(e){if(!1!==r.enabled){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0;l.rotation.y-=.002*t,s.rotation.x-=.002*n,s.rotation.x=Math.max(-g,Math.min(g,s.rotation.x)),a.get("events").publish("player.look",{pitch:s.rotation,yaw:l.rotation})}},b=function(e){switch(e.keyCode){case 38:case 87:d=!0,a.get("events").publish("player.move",{});break;case 37:case 65:u=!0,a.get("events").publish("player.move",{});break;case 40:case 83:h=!0,a.get("events").publish("player.move",{});break;case 39:case 68:p=!0,a.get("events").publish("player.move",{});break;case 32:!0===v&&(f.y=10,a.get("events").publish("player.jump",{})),v=!1}},k=function(e){switch(e.keyCode){case 38:case 87:d=!1;break;case 37:case 65:u=!1;break;case 40:case 83:h=!1;break;case 39:case 68:p=!1}};document.addEventListener("mousemove",w,!1),document.addEventListener("touchmove",w,!1),document.addEventListener("keydown",b,!1),document.addEventListener("keyup",k,!1),this.enabled=!1,this.getObject=function(){return l},this.getDirection=function(e){e.set(0,0,-1),c.multiplyVector3(e)};var x=new o.Vector3,M=new o.Euler;this.update=function(e){!1!==r.enabled&&(e*=.1,x.set(0,0,0),d&&(x.z=-.5*e),h&&(x.z=.5*e),u&&(x.x=-.5*e),p&&(x.x=.5*e),M.y=l.rotation.y,M.order="XYZ",c.setFromEuler(M),x.applyQuaternion(c),f.x+=x.x,f.z+=x.z,(Math.abs(f.x)>4||Math.abs(f.z)>4)&&v&&(d||h||u||p)?n.play():d||h||u||p||!v||(f.x*=.675,f.z*=.675),l.position.copy(t.position))}}},function(e,t,n){"use strict";var o=n(3),i=n(0);e.exports=function(e){var t=document.getElementById("blocker"),n=document.getElementById("instructions");if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){var a=document.body,r=function(n){i.get("events").publish("system.pointerlock.enter",{}),document.pointerLockElement===a||document.mozPointerLockElement===a||document.webkitPointerLockElement===a?(e.enabled=!0,t.style.display="none"):e.enabled=!1},s=function(e){n.style.display=""};document.addEventListener("pointerlockchange",r,!1),document.addEventListener("mozpointerlockchange",r,!1),document.addEventListener("webkitpointerlockchange",r,!1),document.addEventListener("pointerlockerror",s,!1),document.addEventListener("mozpointerlockerror",s,!1),document.addEventListener("webkitpointerlockerror",s,!1),o(".pntrlk").click(function(e){if(n.style.display="none",a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock,/Firefox/i.test(navigator.userAgent)){var t=function e(t){document.fullscreenElement!==a&&document.mozFullscreenElement!==a&&document.mozFullScreenElement!==a||(document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),a.requestPointerLock())};document.addEventListener("fullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),a.requestFullscreen=a.requestFullscreen||a.mozRequestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen,a.requestFullscreen()}else a.requestPointerLock()})}else n.innerHTML="Your browser doesn't seem to support Pointer Lock API"}},function(e,t,n){"use strict";var o=n(4),i=n(0),a=n(3),r=n(1);n(2);e.exports=function e(t){requestAnimationFrame(e),i.get("controls").enabled&&i.get("world").step(1/60);var n=!0,s=!1,l=void 0;try{for(var c,d=i.get("entities")[Symbol.iterator]();!(n=(c=d.next()).done);n=!0){c.value.update(t)}}catch(e){s=!0,l=e}finally{try{!n&&d.return&&d.return()}finally{if(s)throw l}}var h=!0,u=!1,p=void 0;try{for(var v,m=i.get("tweens")[Symbol.iterator]();!(h=(v=m.next()).done);h=!0){v.value.update(t)}}catch(e){u=!0,p=e}finally{try{!h&&m.return&&m.return()}finally{if(u)throw p}}if(i.get("entities").length<30){var y="slime";Math.random()<.25?y="slime.red":Math.random()<.05&&(y="slime.blue");new o.Creature(y,{pos:{x:Math.interval(i.get("player").mesh.position.x-200,i.get("player").mesh.position.x+200),y:30,z:Math.interval(i.get("player").mesh.position.z-200,i.get("player").mesh.position.z+200),override:!1},sounds:[null,"slime-attack.wav","slime-hurt.wav","slime-die.wav"]})}i.get("player").body.position.y<-100?i.get("player").body.position.set(0,15,0):i.get("player").body.position.y<-20?a("#overlay").css("background","blue").css("opacity",.5).show():a("#overlay").hide(),i.get("controls").update(Date.now()-i.get("time")),i.get("renderer").render(i.get("scene"),i.get("camera")),i.set("time",Date.now()),i.set("tick",i.get("tick")+1);var f=new r.Raycaster;f.set(i.get("camera").getWorldPosition(),i.get("camera").getWorldDirection());var g=!0,w=!1,b=void 0;try{for(var k,x=i.get("entities")[Symbol.iterator]();!(g=(k=x.next()).done);g=!0){var M=k.value;f.intersectObjects(M.mesh.children,!0).length?(a("#label").html(M.data.name+" ("+M.hp+"/"+M.hpMax+")"),a("#crosshair").attr("src","/assets/img/crosshair/crosshair-enemy.png")):i.get("tick")%30==0&&(a("#label").html(""),a("#crosshair").attr("src","/assets/img/crosshair/crosshair.png"))}}catch(e){w=!0,b=e}finally{try{!g&&x.return&&x.return()}finally{if(w)throw b}}i.get("events").publish("system.update",{delta:t})}},function(e,t,n){"use strict";function o(e){if(s.get("controls").enabled){var t=new a.Raycaster;if(t.set(s.get("camera").getWorldPosition(),s.get("camera").getWorldDirection()),l&&Date.now()-s.get("player").lastAttacked>800){s.get("events").publish("player.attack",{});var n=new r.Tween(l.rotation).to({x:[-Math.PI/2,0]},800).onStart(function(){c.play()}).start();s.get("tweens").push(n),s.get("player").lastAttacked=Date.now();var o=!0,i=!1,d=void 0;try{for(var h,u=s.get("entities")[Symbol.iterator]();!(o=(h=u.next()).done);o=!0){var p=h.value;t.intersectObjects(p.mesh.children,!0).length&&s.get("player").mesh.position.distanceTo(p.mesh.position)<5&&(p.callEvent("click"),s.get("player").attack(p))}}catch(e){i=!0,d=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw d}}}}}function i(e){var t=new a.Raycaster;t.set(s.get("camera").getWorldPosition(),s.get("camera").getWorldDirection());var n=!0,o=!1,i=void 0;try{for(var r,l=s.get("entities")[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var c=r.value;t.intersectObjects(c.mesh.children,!0).length&&c.callEvent("interact")}}catch(e){o=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw i}}}var a=n(1),r=n(5),s=n(0),l=void 0,c=new Audio("/assets/sfx/sword.mp3");c.volume=.1,window.addEventListener("mousedown",function(e){s.get("events").publish("system.click",e),2==e.which||4==e.button?i(e):o(e)}),window.addEventListener("keyup",function(e){return!(69==e.keyCode)||i()}),(new a.ObjectLoader).load("/assets/3d/sword/sword.json",function(e){s.get("camera").add(e),e.scale.set(.1,.1,.1),e.position.x++,e.position.y-=1.2,e.position.z-=1.25,l=e})},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),r=n(3),s=function(){function e(t,n){o(this,e),r("#gui-title").text(t),r("#gui-content").html(n),this.show(),document.exitPointerLock()}return i(e,[{key:"show",value:function(){r("#gui").fadeIn(400)}},{key:"hide",value:function(){r("#gui").fadeOut(400)}}]),e}();t.default=s;var l=t.Inventory=function e(){o(this,e);var t=a.get("player").inv,n=r("<div>"),i=!0,l=!1,c=void 0;try{for(var d,h=t[Symbol.iterator]();!(i=(d=h.next()).done);i=!0){var u=d.value;r("<img>").attr("src",u.path).attr("title",u.name).attr("width",50).data("item",u).appendTo(n)}}catch(e){l=!0,c=e}finally{try{!i&&h.return&&h.return()}finally{if(l)throw c}}n.on("click","img",function(){if(r(this).hide(),r(this).data("item").effects)for(var e in r(this).data("item").effects)a.get("player")[e]+=r(this).data("item").effects[e];a.get("player").inv.splice(a.get("player").inv.indexOf(r(this).data("item"),1))}),new s("Inventory",n)};window.addEventListener("keypress",function(e){73!=e.keyCode&&105!=e.keyCode||new l}),r(document).keyup(function(e){"escape"==e.key.toLowerCase()&&new s("Paused","The Grove is currently paused. :)")})}],[6]);