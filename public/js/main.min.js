webpackJsonp([0],[,function(e,t,o){"use strict";var n=o(0),i=o(2),a=o(8),r=e.exports=new Map;r.set("time",Date.now()),r.set("tick",0),r.set("controls",{}),r.set("scene",new n.Scene),r.set("renderer",new n.WebGLRenderer),r.set("camera",new n.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,5e3)),r.set("listener",new n.AudioListener),r.get("camera").add(r.get("listener")),r.set("player",{}),r.set("entities",[]),r.set("labels",[]),r.set("tweens",[]),r.set("world",new i.World),r.set("events",a.channel("events")),r.set("load",function(e,t){t=t||{},e.castShadow=!0,e.receiveShadow=!0;for(var o=[],n=[],a=0;a<e.geometry.vertices.length;a++){var s=e.geometry.vertices[a];o.push(new i.Vec3(s.x,s.y,s.z))}for(var a=0;a<e.geometry.faces.length;a++){var l=e.geometry.faces[a];n.push([l.a,l.b,l.c])}var c=new i.ConvexPolyhedron(o,n),d=new i.Body({mass:t.mass||0,material:t.material||void 0});return d.addShape(c),d.position.copy(e.position),d.quaternion.copy(e.quaternion),r.get("world").add(d),{body:d,shape:c,mesh:e}})},,,function(e,t,o){"use strict";function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,o,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,o);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,o,n)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(n)},s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),l=o(0),c=o(2),d=o(5),h=o(1),u=o(3),p=t.Entity=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Entity",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new l.Object3D,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new c.Body,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(a(this,e),console.log("Entity: "+t+" created"),this.id=t,this.uuid=Math.random(),this.events={},this.opts=i,this.sounds=[],this.opts.sounds)for(var r=0;r<this.opts.sounds.length;r++)this.loadAudio(this.opts.sounds[r],r);this.mesh=o,this.mesh.name=this.id,this.body=n,h.get("scene").add(o),h.get("world").add(n),h.get("entities").push(this)}return s(e,[{key:"update",value:function(e){this.mesh.position.copy(this.body.position),this.callEvent("update")}},{key:"remove",value:function(){this.callEvent("remove"),h.get("scene").remove(this.mesh),h.get("world").remove(this.body),h.get("entities").splice(h.get("entities").indexOf(this),1)}},{key:"loadAudio",value:function(e,t){var o=this;if(e){(new l.AudioLoader).load("/assets/sfx/"+e,function(e){o.sounds[t]=new l.PositionalAudio(h.get("listener")),o.sounds[t].setBuffer(e),o.sounds[t].setRefDistance(5),o.mesh.add(o.sounds[t]),o.sounds[t].onEnded(function(){return o.sounds[t].stop()})})}}},{key:"addEventListener",value:function(e,t){e in this.events||(this.events[e]=[]),this.events[e].push(t)}},{key:"removeEventListener",value:function(e,t){}},{key:"callEvent",value:function(e){if(e in this.events){var t=!0,o=!1,n=void 0;try{for(var i,a=this.events[e][Symbol.iterator]();!(t=(i=a.next()).done);t=!0){(0,i.value)()}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}}}]),e}(),m=t.Living=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Living Entity",o=arguments[1],i=arguments[2],r=arguments[3];a(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,i,r));return s.lastDamaged=0,s.lastAttacked=0,s.hp=Number,s.hpMax=Number,s.mp=Number,s.mpMax=Number,s.stm=Number,s.stmMax=Number,s.str=Number,s.dex=Number,s.int=Number,s.cnt=Number,s.chr=Number,s.inv=[],s.effects=[],s}return i(t,e),s(t,[{key:"attack",value:function(e){h.get("controls").enabled&&(e.damage(this.dmg),this.lastAttacked=Date.now(),this.callEvent("attack"))}},{key:"damage",value:function(e){h.get("controls").enabled&&(this.hp-=e,this.hp<=0&&this.kill(),this.lastDamaged=Date.now(),this.callEvent("damage"))}},{key:"heal",value:function(e){h.get("controls").enabled&&(Date.now()-this.lastDamaged>5e3&&(this.hp+=e),this.hp>=this.hpMax&&(this.hp=this.hpMax),this.callEvent("heal"))}},{key:"kill",value:function(){h.get("controls").enabled&&(this.remove(),this.callEvent("kill"))}},{key:"update",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e),h.get("tick")%50==0&&this.heal(1)}}]),t}(p),v=t.AI=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"AI",o=arguments[1],i=arguments[2],r=arguments[3];a(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o,i,r));return s.target=null,s.seen=!1,s.tween=!1,s.hp=5,s.hpMax=5,s.mp=1,s.mpMax=1,s.stm=3,s.stmMax=3,s.str=1,s.dex=1,s.int=1,s.cnt=1,s.chr=1,s}return i(t,e),s(t,[{key:"update",value:function(e){var o=this;r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e);var n=this.mesh.position,i=!0,a=!1,s=void 0;try{for(var c,u=h.get("entities")[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var p=c.value;p==h.get("player")&&(n.distanceTo(p.mesh.position)>50||(this.target&&n.distanceTo(p.mesh.position)<n.distanceTo(this.target.mesh.position)?(this.target=p,this.sounds[0]&&h.get("controls").enabled&&this.sounds[0].play()):this.target||(this.target=p)))}}catch(e){a=!0,s=e}finally{try{!i&&u.return&&u.return()}finally{if(a)throw s}}this.target&&n.distanceTo(this.target.mesh.position)>50&&(this.target=null);var m=this.spd||7;if(this.addEventListener("damage",function(){o.sounds[2]&&h.get("controls").enabled&&!o.sounds[2].isPlaying&&o.hp>0&&o.sounds[2].play()}),this.addEventListener("kill",function(){o.sounds[3]&&h.get("controls").enabled&&!o.sounds[3].isPlaying&&o.sounds[3].play()}),this.target){var v=this.target.mesh.position;if(!this.tween){this.tween=!0;var y=(new l.Euler).copy(this.mesh.rotation);this.mesh.lookAt(new l.Vector3(v.x,n.y,v.z));var f=(new l.Euler).copy(this.mesh.rotation);this.mesh.rotation.copy(y);var g=new d.Tween(this.mesh.rotation).to({x:y.x,y:f.y,z:y.z},60).start().onComplete(function(){o.tween=!1,h.get("tweens").splice(h.get("tweens").indexOf(g),1)});h.get("tweens").push(g)}n.distanceTo(v)>(this.opts.hostility<0?5:12)?(n.x<v.x?this.body.velocity.x++:n.x>v.x&&this.body.velocity.x--,n.z<v.z?this.body.velocity.z++:n.z>v.z&&this.body.velocity.z--):h.get("tick")%50==0&&this.opts.hostility<0&&(this.attack(this.target),this.sounds[1]&&this.sounds[1].play())}else this.body.velocity.x=0,this.body.velocity.z=0;this.body.velocity.x>m?this.body.velocity.x=m:this.body.velocity.x<-m&&(this.body.velocity.x=-m),this.body.velocity.z>m?this.body.velocity.z=m:this.body.velocity.z<-m&&(this.body.velocity.z=-m)}}]),t}(m);t.Player=function(e){function t(){a(this,t);var e=new c.Sphere(1.3),o=new c.Body({mass:5});o.addShape(e);var i=new l.Raycaster(new l.Vector3(0,40,0),new l.Vector3(0,-1,0)),r=i.intersectObjects(h.get("scene").children,!0);if(r.length>0){var s=r[0].point;o.position.set(s.x,s.y,s.z)}else o.position.set(200,20,0);var d=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"Player",new l.Object3D,o));return d.hp=20,d.hpMax=20,d.spd=1,d.dmg=1,d}return i(t,e),s(t,[{key:"update",value:function(e){r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this,e),u("#hp").html(this.hp+"/"+this.hpMax+" hp"),this.body.velocity.x*=.925,this.body.velocity.z*=.925}}]),t}(m),t.Enemy=function(e){function t(e,i){a(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,new l.Object3D,new c.Body,i)),s=o(13);if(!s[e])throw new Error("Error: cannot find enemy with id of "+e);var d=s[e];r.data=d,r.opts.hostility=-1,r.inv=d.inv;for(var u in d.stats)r[u]=d.stats[u];return(new l.ObjectLoader).load("/assets/3d/"+d.path+".json",function(e){var t=new c.Body({mass:5});t.addShape(new c.Sphere(1));var o=void 0;if(o=new c.Vec3(i.pos.x||10,i.pos.y||20,i.pos.z||10),d.meta&&d.meta.spawn){var n=d.meta.spawn;o=6==n.length?new c.Vec3(Math.interval(n[0],n[1]),Math.interval(n[2],n[3]),Math.interval(n[4],n[5])):new c.Vec3(n[0],n[1],n[2])}var a=new l.Raycaster(new l.Vector3(o.x,o.y,o.z),new l.Vector3(0,-1,0)),s=a.intersectObjects(h.get("scene").children,!0);if(s.length>0){var u=s[0].point;t.position.set(u.x,u.y+3,u.z)}else t.position.set(o.x,o.y,o.z);t.linearDamping=.9,e.traverse(function(e){var t=!0,o=!1,n=void 0;try{for(var i,a=d.mesh[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var r=i.value;if(r.name.toLowerCase()==e.name.toLowerCase())for(var s in r)e.material[s]=r[s],"color"==s&&(e.material[s]=new l.Color(r[s]))}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}),r.label=document.createElement("div"),document.body.appendChild(r.label),r.label.className+="entity-label",r.label.innerHTML=""+d.name,r.label.style.position="absolute",r.mesh=e,h.get("scene").add(r.mesh),r.body=t,h.get("world").add(r.body)}),r.addEventListener("kill",function(){r.label.style.display="none";var t=!0,n=!1,i=void 0;try{for(var a,s=r.inv[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){var l=a.value,c=o(14);if(!c[l.id])throw new Error("Error: cannot find item with id of "+e);var d=Math.round(Math.random()*l.max)+l.min;if(d>l.max&&(d=l.max),d){for(var u=0;u<d;u++)h.get("player").inv.push(c[l.id]);d>1?Materialize.toast(l.id+" ("+d+") added",1e3):Materialize.toast(l.id+" added",1e3)}}}catch(e){n=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw i}}}),r}return i(t,e),s(t,[{key:"update",value:function(){if(r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),(!this.data.meta||!this.data.meta.spawn)&&this.target&&this.mesh.position.distanceTo(this.target.mesh.position)>250?(this.body.position.x=Math.interval(h.get("player").mesh.position.x-200,h.get("player").mesh.position.x+200),this.body.position.y=20,this.body.position.z=Math.interval(h.get("player").mesh.position.z-200,h.get("player").mesh.position.z+200),console.log("Moved.")):this.data.meta&&this.data.meta.spawn||!(this.mesh.position.distanceTo(h.get("player").mesh.position)>450)||(this.body.position.x=Math.interval(h.get("player").mesh.position.x-200,h.get("player").mesh.position.x+200),this.body.position.y=20,this.body.position.z=Math.interval(h.get("player").mesh.position.z-200,h.get("player").mesh.position.z+200),console.log("Moved.")),this.label){this.label.innerHTML=this.data.name+" ("+this.hp+"/"+this.hpMax+")",h.get("camera").updateMatrix(),h.get("camera").updateMatrixWorld();var e=new l.Frustum;e.setFromMatrix((new l.Matrix4).multiplyMatrices(h.get("camera").projectionMatrix,h.get("camera").matrixWorldInverse)),!e.containsPoint(this.mesh.position)||this.mesh.position.distanceTo(h.get("player").mesh.position)>50?this.label.style.display="none":this.label.style.display="block";var n=o(15).ObjCoord.cssPosition(this.mesh,h.get("camera"),h.get("renderer"));this.label.style.left=n.x-this.label.offsetWidth/2+"px",this.label.style.top=n.y-this.label.offsetHeight/2-20+"px"}}}]),t}(v),t.NPC=function(e){function t(e,i){a(this,t);var r=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,new l.Object3D,new c.Body,i)),s=o(16);if(!s[e])throw new Error("Error: cannot find NPC with id of "+e);var d=s[e];r.opts.hostility=1,r.inv=d.inv;for(var u in d.stats)r[u]=d.stats[u];return(new l.ObjectLoader).load("/assets/3d/"+d.path+".json",function(e){e.scale.set(.01,.01,.01);var t=new c.Body({mass:5});t.addShape(new c.Sphere(2.25));var o=void 0;if(o=new c.Vec3(i.pos.x||10,i.pos.y||20,i.pos.z||10),d.meta&&d.meta.spawn){var n=d.meta.spawn;o=6==n.length?new c.Vec3(Math.interval(n[0],n[1]),Math.interval(n[2],n[3]),Math.interval(n[4],n[5])):new c.Vec3(n[0],n[1],n[2])}var a=new l.Raycaster(new l.Vector3(o.x,o.y,o.z),new l.Vector3(0,-1,0)),s=a.intersectObjects(h.get("scene").children,!0);if(s.length>0){var u=s[0].point;t.position.set(u.x,u.y+3,u.z)}else t.position.set(o.x,o.y,o.z);t.linearDamping=.9,r.mesh=e,h.get("scene").add(r.mesh),r.body=t,h.get("world").add(r.body)}),r}return i(t,e),t}(v)},,function(e,t,o){"use strict";var n=o(4).NPC;window.onerror=alert,window.Grove={version:"1.2.2",globals:o(1)},Math.interval=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};new n("wicket",{pos:{},sounds:["wicket.mp3","silence.wav","silence.wav","silence.wav"]});o(17)(),o(18)(),o(23)(),o(24),o(25)},,,,,,,function(e,t){e.exports={slime:{name:"Slime",path:"slime/slime",id:"slime",stats:{hp:3,hpMax:3,dmg:1,spd:5},hostility:[[],["slime","slime.red","slime.blue"],[]],inv:[{id:"gelatin",min:1,max:3}],mesh:[{name:"outer",transparent:!0,opacity:.3}]},"slime.red":{name:"Red Slime",path:"slime/slime",id:"slime.red",stats:{hp:5,hpMax:5,dmg:2,spd:5},hostility:[[],["slime","slime.red","slime.blue"],[]],inv:[{id:"gelatin",min:1,max:2}],meta:{spawn:[-500,200,250,300,310,390]},mesh:[{name:"outer",transparent:!0,opacity:.3,color:16711680},{name:"inner",color:16711680}]},"slime.blue":{name:"Blue Slime",path:"slime/slime",id:"slime.blue",stats:{hp:1,hpMax:1,dmg:7,spd:15},hostility:[[],["slime","slime.red","slime.blue"],[]],inv:[{id:"gelball",min:1,max:2}],mesh:[{name:"outer",transparent:!0,opacity:.3,color:255},{name:"inner",color:255}]}}},function(e,t){e.exports={gelatin:{name:"Gelatin",id:"#000001",desc:"Like jello, but not edible.",path:"/assets/icons/gelatin.png",weight:1,value:3,effects:{hp:-1}},gelball:{name:"Ball of Gel",id:"#000002",desc:"Compressed gelatin, has distinctive healing properties.",path:"/assets/icons/slow-blob.png",weight:3,value:3,effects:{hp:5}}}},function(e,t,o){"use strict";var n=n||{},i=o(0);n.ObjCoord=function(e){return this.screenPosition=function(t){return n.ObjCoord.screenPosition(e,t)},this.worldPosition=function(){return n.ObjCoord.worldPosition(e)},this.cssPosition=function(t,o){return n.ObjCoord.cssPosition(e,t,o)},this},n.ObjCoord.worldPosition=function(e){e.updateMatrixWorld();var t=e.matrixWorld;return(new i.Vector3).setFromMatrixPosition(t)},n.ObjCoord.screenPosition=function(e,t){var o=this.worldPosition(e);return this.convertWorldToScreenSpace(o,t)},n.ObjCoord.cssPosition=function(e,t,o){var n=this.screenPosition(e,t);return n.x=(n.x/2+.5)*o.domElement.width/o.getPixelRatio(),n.y=(1-(n.y/2+.5))*o.domElement.height/o.getPixelRatio(),n},n.ObjCoord.convertWorldToScreenSpace=function(e,t){var o=this.projector||new i.Projector;return this.projector=o,e.clone().project(t)},n.ObjCoord.VisiblePlaneHeight=function(e,t){var o=e.fov*Math.PI/180;return 2*Math.tan(o/2)*t},n.ObjCoord.VisiblePlaneWidth=function(e,t,o){return n.ObjCoord.VisiblePlaneHeight(e,o)*(t.domElement.width/t.domElement.height)},e.exports=n},function(e,t){e.exports={wicket:{name:"Wicket",id:"wicket",path:"wicket/wicket",stats:{hp:3,hpMax:3,spd:15},meta:{spawn:[115,32,-30]}}}},function(e,t,o){"use strict";var n=o(4),i=o(2),a=(o(0),o(1)),r=a.get("world");e.exports=function(){r.quatNormalizeSkip=0,r.quatNormalizeFast=!1;var e=new i.GSSolver;r.defaultContactMaterial.contactEquationStiffness=1e9,r.defaultContactMaterial.contactEquationRelaxation=4,e.iterations=7,e.tolerance=.1;r.solver=new i.SplitSolver(e),r.gravity.set(0,-20,0),r.broadphase=new i.NaiveBroadphase;var t=new i.Material("slipperyMaterial"),o=new i.ContactMaterial(t,t,0,.3);r.addContactMaterial(o),a.set("player",new n.Player)}},function(e,t,o){"use strict";function n(){r.get("camera").aspect=window.innerWidth/window.innerHeight,r.get("camera").updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight),console.log("Window resized to "+window.innerWidth+", "+window.innerHeight)}var i=o(3),a=o(0),r=(o(2),o(1)),s=r.get("renderer"),l=r.get("scene");e.exports=function(){var e=o(19);a.DefaultLoadingManager.onProgress=function(e,t,o){console.log("Loading "+e+" ("+t+"/"+o+")"),i("#loaded").text(Math.floor(t/o*100)+"% - v."+window.Grove.version)},a.DefaultLoadingManager.onLoad=function(){console.log("Loading complete"),i("#instructions").has("h4").length||i("#instructions").html("<h4>"+e[Math.floor(Math.random()*e.length)]+"</h4>")},a.DefaultLoadingManager.onError=function(e){console.error("Error loading "+e)},l.fog=new a.FogExp2(16777215,.005);var t=o(20).DayNight,c=new t.SunSphere;l.add(c.object3d);var d=new t.Skydom;l.add(d.object3d);var h=new t.SunLight;l.add(h.object3d);var u=1/6*Math.PI*2,p=new a.AmbientLight(2236962);l.add(p),r.get("events").subscribe("system.update",function(e){r.get("controls").enabled&&(u+=1e-5*Math.PI*2,c.update(u),d.update(u),h.update(u))});var m=o(21);r.set("controls",new m(r.get("camera"),r.get("player").body)),l.add(r.get("controls").getObject()),o(22)(r.get("controls")),(new a.ObjectLoader).load("/assets/3d/skjar-isles/skjar-isles.json",function(e){l.add(e),e.castShadow=!0,e.receiveShadow=!0,e.traverse(function(e){e.castShadow=!0,e.receiveShadow=!0,e instanceof a.Mesh&&!/NP/gi.test(e.name)&&(console.log("Loading "+e.name),r.get("load")(e))})}),s.shadowMap.enabled=!0,s.shadowMapSoft=!0,s.setSize(window.innerWidth,window.innerHeight),s.setClearColor(l.fog.color,1),document.body.appendChild(s.domElement),window.addEventListener("resize",n,!1)}},function(e,t){e.exports=["While the island's mountains may be fun to climb, keep a look out; they are teeming with some of The Grove's more formiddable creatures.","OOOOO OOOOO OOOOO - Hunter Sokolis, time unknown","There is currently no fall damage in the game - take advantage of that while you can.","A slime's power depends on its color. Green slimes are easy to beat, whereas red slimes are harder.","Please ignore our crappy graphics","Can you find Hunter's hidden characters?","There will be an update to this game eventually. Keyword is eventually.","Can you find the mysterious ButtBook?","How many slimes can you kill?","Beware the foul-smelling train!"]},function(e,t,o){"use strict";var n=o(0),i=e.exports=i||{};i.DayNight={},i.DayNight.baseURL="../",i.DayNight.currentPhase=function(e){return Math.sin(e)>Math.sin(0)?"day":Math.sin(e)>Math.sin(-Math.PI/6)?"twilight":"night"},i.DayNight.StarField=function(){var e=n.ImageUtils.loadTexture(i.DayNight.baseURL+"images/galaxy_starfield.png"),t=new n.MeshBasicMaterial({map:e,side:n.BackSide,color:8421504}),o=new n.SphereGeometry(4500,32,32),a=new n.Mesh(o,t);this.object3d=a,this.update=function(e){var o=i.DayNight.currentPhase(e);if("day"===o)a.visible=!1;else if("twilight"===o)a.visible=!1;else{a.visible=!0,a.rotation.y=e/5;var n=Math.abs(Math.sin(e));t.color.setRGB(n,n,n)}}},i.DayNight.SunLight=function(){var e=new n.DirectionalLight(16777215,1);this.object3d=e,this.update=function(t){e.position.x=0,e.position.y=9e4*Math.sin(t),e.position.z=9e4*Math.cos(t);var o=i.DayNight.currentPhase(t);"day"===o?e.color.set("rgb(255,"+(Math.floor(200*Math.sin(t))+55)+","+Math.floor(200*Math.sin(t))+")"):"twilight"===o?(e.intensity=1,e.color.set("rgb("+(255-Math.floor(510*Math.sin(t)*-1))+","+(55-Math.floor(110*Math.sin(t)*-1))+",0)")):e.intensity=1}},i.DayNight.SunSphere=function(){var e=new n.SphereGeometry(20,30,30),t=new n.MeshBasicMaterial({color:16711680}),o=new n.Mesh(e,t);this.object3d=o,this.update=function(e){o.position.x=0,o.position.y=400*Math.sin(e),o.position.z=400*Math.cos(e);var t=i.DayNight.currentPhase(e);"day"===t?o.material.color.set("rgb(255,"+(Math.floor(200*Math.sin(e))+55)+","+(Math.floor(200*Math.sin(e))+5)+")"):"twilight"===t&&o.material.color.set("rgb(255,55,5)")}},i.DayNight.Skydom=function(){var e=new n.SphereGeometry(4500,32,15),t=i.DayNight.Skydom.Shader,o=n.UniformsUtils.clone(t.uniforms),a=new n.ShaderMaterial({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:o,side:n.BackSide}),r=new n.Mesh(e,a);this.object3d=r,this.update=function(e){var t=i.DayNight.currentPhase(e);"day"===t?(o.topColor.value.set("rgb(0,120,255)"),o.bottomColor.value.set("rgb(255,"+(Math.floor(200*Math.sin(e))+55)+","+Math.floor(200*Math.sin(e))+")")):"twilight"===t?(o.topColor.value.set("rgb(0,"+(120-Math.floor(240*Math.sin(e)*-1))+","+(255-Math.floor(510*Math.sin(e)*-1))+")"),o.bottomColor.value.set("rgb("+(255-Math.floor(510*Math.sin(e)*-1))+","+(55-Math.floor(110*Math.sin(e)*-1))+",0)")):(o.topColor.value.set("black"),o.bottomColor.value.set("black"))}},i.DayNight.Skydom.Shader={uniforms:{topColor:{type:"c",value:(new n.Color).setHSL(.6,1,.75)},bottomColor:{type:"c",value:new n.Color(16777215)},offset:{type:"f",value:400},exponent:{type:"f",value:.6}},vertexShader:["varying vec3 vWorldPosition;","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 topColor;","uniform vec3 bottomColor;","uniform float offset;","uniform float exponent;","varying vec3 vWorldPosition;","void main() {","\tfloat h = normalize( vWorldPosition + offset ).y;","\tgl_FragColor = vec4( mix( bottomColor, topColor, max( pow( h, exponent ), 0.0 ) ), 1.0 );","}"].join("\n")}},function(e,t,o){"use strict";var n=o(0),i=o(2),a=o(1);e.exports=function(e,t){var o=new Audio("/assets/sfx/leaves01.ogg"),r=this,s=new n.Object3D;s.add(e);var l=new n.Object3D;l.position.y=2,l.add(s);var c=new n.Quaternion,d=!1,h=!1,u=!1,p=!1,m=!1,v=new i.Vec3,y=new i.Vec3(0,1,0);t.addEventListener("collide",function(e){var o=e.contact;if(o.bi.id==t.id?o.ni.negate(v):v.copy(o.ni),v.dot(y)>.5){if(m=!0,!a.get("player"))return;var n=a.get("player").body.velocity.y;n<=-60&&a.get("player").damage(-Math.floor(n))}});var f=t.velocity,g=Math.PI/2,w=function(e){if(!1!==r.enabled){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,o=e.movementY||e.mozMovementY||e.webkitMovementY||0;l.rotation.y-=.002*t,s.rotation.x-=.002*o,s.rotation.x=Math.max(-g,Math.min(g,s.rotation.x)),a.get("events").publish("player.look",{pitch:s.rotation,yaw:l.rotation})}},b=function(e){switch(e.keyCode){case 38:case 87:d=!0;break;case 37:case 65:u=!0;break;case 40:case 83:h=!0;break;case 39:case 68:p=!0;break;case 32:!0===m&&(f.y=10),m=!1}},x=function(e){switch(e.keyCode){case 38:case 87:d=!1;break;case 37:case 65:u=!1;break;case 40:case 83:h=!1;break;case 39:case 68:p=!1}};document.addEventListener("mousemove",w,!1),document.addEventListener("touchmove",w,!1),document.addEventListener("keydown",b,!1),document.addEventListener("keyup",x,!1),this.enabled=!1,this.getObject=function(){return l},this.getDirection=function(e){e.set(0,0,-1),c.multiplyVector3(e)};var M=new n.Vector3,k=new n.Euler;this.update=function(e){!1!==r.enabled&&(e*=.1,M.set(0,0,0),a.get("events").publish("player.move",{}),d&&(M.z=-.5*e),h&&(M.z=.5*e),u&&(M.x=-.5*e),p&&(M.x=.5*e),k.y=l.rotation.y,k.order="XYZ",c.setFromEuler(k),M.applyQuaternion(c),f.x+=M.x,f.z+=M.z,(Math.abs(f.x)>3||Math.abs(f.z)>3)&&m&&o.play(),l.position.copy(t.position))}}},function(e,t,o){"use strict";var n=o(3);e.exports=function(e){var t=document.getElementById("blocker"),o=document.getElementById("instructions");if("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document){var i=document.body,a=function(o){document.pointerLockElement===i||document.mozPointerLockElement===i||document.webkitPointerLockElement===i?(e.enabled=!0,t.style.display="none"):e.enabled=!1},r=function(e){o.style.display=""};document.addEventListener("pointerlockchange",a,!1),document.addEventListener("mozpointerlockchange",a,!1),document.addEventListener("webkitpointerlockchange",a,!1),document.addEventListener("pointerlockerror",r,!1),document.addEventListener("mozpointerlockerror",r,!1),document.addEventListener("webkitpointerlockerror",r,!1),n(".pntrlk").click(function(e){if(o.style.display="none",i.requestPointerLock=i.requestPointerLock||i.mozRequestPointerLock||i.webkitRequestPointerLock,/Firefox/i.test(navigator.userAgent)){var t=function e(t){document.fullscreenElement!==i&&document.mozFullscreenElement!==i&&document.mozFullScreenElement!==i||(document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),i.requestPointerLock())};document.addEventListener("fullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),i.requestFullscreen=i.requestFullscreen||i.mozRequestFullscreen||i.mozRequestFullScreen||i.webkitRequestFullscreen,i.requestFullscreen()}else i.requestPointerLock()})}else o.innerHTML="Your browser doesn't seem to support Pointer Lock API"}},function(e,t,o){"use strict";var n=o(4),i=o(1),a=o(3),r=o(0);o(2);e.exports=function e(t){requestAnimationFrame(e),i.get("controls").enabled&&i.get("world").step(1/60);var o=!0,s=!1,l=void 0;try{for(var c,d=i.get("entities")[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){c.value.update(t)}}catch(e){s=!0,l=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw l}}var h=!0,u=!1,p=void 0;try{for(var m,v=i.get("tweens")[Symbol.iterator]();!(h=(m=v.next()).done);h=!0){m.value.update(t)}}catch(e){u=!0,p=e}finally{try{!h&&v.return&&v.return()}finally{if(u)throw p}}if(i.get("entities").length<20){var y="slime";Math.random()<.45?y="slime.red":Math.random()<.025&&(y="slime.blue");new n.Enemy(y,{pos:{x:Math.interval(i.get("player").mesh.position.x-200,i.get("player").mesh.position.x+200),y:20,z:Math.interval(i.get("player").mesh.position.z-200,i.get("player").mesh.position.z+200),override:!1},sounds:["wicket.mp3","slime-attack.wav","slime-hurt.wav","slime-die.wav"]})}i.get("player").body.position.y<-100&&i.get("player").body.position.set(0,15,0),i.get("controls").update(Date.now()-i.get("time")),i.get("renderer").render(i.get("scene"),i.get("camera")),i.set("time",Date.now()),i.set("tick",i.get("tick")+1);var f=new r.Raycaster;f.set(i.get("camera").getWorldPosition(),i.get("camera").getWorldDirection());var g=!0,w=!1,b=void 0;try{for(var x,M=i.get("entities")[Symbol.iterator]();!(g=(x=M.next()).done);g=!0){var k=x.value;f.intersectObjects(k.mesh.children,!0).length?a("#crosshair").attr("src","/assets/img/crosshair/crosshair-enemy.png"):i.get("tick")%30==0&&a("#crosshair").attr("src","/assets/img/crosshair/crosshair.png")}}catch(e){w=!0,b=e}finally{try{!g&&M.return&&M.return()}finally{if(w)throw b}}i.get("events").publish("system.update",{delta:t})}},function(e,t,o){"use strict";function n(e){if(s.get("controls").enabled){var t=new a.Raycaster;if(t.set(s.get("camera").getWorldPosition(),s.get("camera").getWorldDirection()),l&&Date.now()-s.get("player").lastAttacked>800){var o=new r.Tween(l.rotation).to({x:[-Math.PI/2,0]},800).onStart(function(){c.play()}).start();s.get("tweens").push(o),s.get("player").lastAttacked=Date.now();var n=!0,i=!1,d=void 0;try{for(var h,u=s.get("entities")[Symbol.iterator]();!(n=(h=u.next()).done);n=!0){var p=h.value;t.intersectObjects(p.mesh.children,!0).length&&s.get("player").mesh.position.distanceTo(p.mesh.position)<5&&(p.callEvent("click"),s.get("player").attack(p))}}catch(e){i=!0,d=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw d}}}}}function i(e){var t=new a.Raycaster;t.set(s.get("camera").getWorldPosition(),s.get("camera").getWorldDirection());var o=!0,n=!1,i=void 0;try{for(var r,l=s.get("entities")[Symbol.iterator]();!(o=(r=l.next()).done);o=!0){var c=r.value;t.intersectObjects(c.mesh.children,!0).length&&c.callEvent("interact")}}catch(e){n=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(n)throw i}}}var a=o(0),r=o(5),s=o(1),l=void 0,c=new Audio("/assets/sfx/sword.mp3");c.volume=.3,window.addEventListener("mousedown",function(e){2==e.which||4==e.button?i(e):n(e)}),window.addEventListener("keyup",function(e){return!(69==e.keyCode)||i()}),(new a.ObjectLoader).load("/assets/3d/sword/sword.json",function(e){s.get("camera").add(e),e.scale.set(.1,.1,.1),e.position.x++,e.position.y-=1.2,e.position.z-=1.25,l=e})},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=o(1),r=o(3),s=function(){function e(t,o){n(this,e),r("#gui-title").text(t),r("#gui-content").html(o),this.show(),document.exitPointerLock()}return i(e,[{key:"show",value:function(){r("#gui").fadeIn(400)}},{key:"hide",value:function(){r("#gui").fadeOut(400)}}]),e}();t.default=s;var l=t.Inventory=function e(){n(this,e);var t=a.get("player").inv,o=r("<div>"),i=!0,l=!1,c=void 0;try{for(var d,h=t[Symbol.iterator]();!(i=(d=h.next()).done);i=!0){var u=d.value;r("<img>").attr("src",u.path).attr("title",u.name).attr("width",50).data("item",u).appendTo(o)}}catch(e){l=!0,c=e}finally{try{!i&&h.return&&h.return()}finally{if(l)throw c}}o.on("click","img",function(){if(r(this).hide(),r(this).data("item").effects)for(var e in r(this).data("item").effects)a.get("player")[e]+=r(this).data("item").effects[e];a.get("player").inv.splice(a.get("player").inv.indexOf(r(this).data("item"),1))}),new s("Inventory",o)};window.addEventListener("keypress",function(e){73!=e.keyCode&&105!=e.keyCode||new l}),r(document).keyup(function(e){"escape"==e.key.toLowerCase()&&new s("Paused","The Grove is currently paused. :)")})}],[6]);